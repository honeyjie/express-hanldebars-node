define(["jquery","fullpage","scrollbar","base","common","d3"],function(e,t,l,s,n,i){function a(){s.openMask(),$("body").css("overflow","hidden"),$(".select-form-view").removeClass("hidden").addClass("animated fadeInDown").one(s.animationend,function(){$(".select-form-view").removeClass("animated fadeInDown")})}function o(){for(var e=$(".select-box .select-content"),t=1;t<e.length;t++)v[t]=e.eq(t).innerHeight(),e.eq(t).css("height",0),e.eq(t).parents(".select-box").find(".select-title-control").addClass("animated rotateDown")}function c(){p.nation.length>0&&p.locatioin.length>0&&($(".select-box").eq(0).find(".select-title").hasClass("error")?$(".select-box").eq(0).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(1).find(".select-content").css("height")&&$(".select-box").eq(1).find(".select-title-control").click())}function r(){p.pre_school&&p.school_type&&p.pre_major&&p.grade&&null!==p.related_major&&p.degree&&($(".select-box").eq(1).find(".select-title").hasClass("error")?$(".select-box").eq(1).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(2).find(".select-content").css("height")&&$(".select-box").eq(2).find(".select-title-control").click())}function f(){"法学"==p.pre_major?"toefl"==p.language?p.gpa&&p.toefl&&p.toefl_r&&p.toefl_l&&p.toefl_s&&p.toefl_w&&null!==p.lsat&&($(".select-box").eq(2).find(".select-title").hasClass("error")?$(".select-box").eq(2).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(3).find(".select-content").css("height")&&$(".select-box").eq(3).find(".select-title-control").click()):"ielts"==p.language&&p.gpa&&p.ielts&&p.ielts_r&&p.ielts_l&&p.ielts_s&&p.ielts_w&&null!==p.lsat&&($(".select-box").eq(2).find(".select-title").hasClass("error")?$(".select-box").eq(2).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(3).find(".select-content").css("height")&&$(".select-box").eq(3).find(".select-title-control").click()):"toefl"==p.language?"gre"==p.exam?p.gpa&&p.toefl&&p.toefl_r&&p.toefl_l&&p.toefl_s&&p.toefl_w&&p.gre&&p.gre_v&&p.gre_q&&p.gre_aw&&($(".select-box").eq(2).find(".select-title").hasClass("error")?$(".select-box").eq(2).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(3).find(".select-content").css("height")&&$(".select-box").eq(3).find(".select-title-control").click()):"gmat"==p.exam&&p.gpa&&p.toefl&&p.toefl_r&&p.toefl_l&&p.toefl_s&&p.toefl_w&&p.gmat&&p.gmat_v&&p.gmat_q&&p.gmat_aw&&($(".select-box").eq(2).find(".select-title").hasClass("error")?$(".select-box").eq(2).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(3).find(".select-content").css("height")&&$(".select-box").eq(3).find(".select-title-control").click()):"ielts"==p.language&&("gre"==p.exam?p.gpa&&p.ielts&&p.ielts_r&&p.ielts_l&&p.ielts_s&&p.ielts_w&&p.gre&&p.gre_v&&p.gre_q&&p.gre_aw&&($(".select-box").eq(2).find(".select-title").hasClass("error")?$(".select-box").eq(2).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(3).find(".select-content").css("height")&&$(".select-box").eq(3).find(".select-title-control").click()):"gmat"==p.exam&&p.gpa&&p.ielts&&p.ielts_r&&p.ielts_l&&p.ielts_s&&p.ielts_w&&p.gmat&&p.gmat_v&&p.gmat_q&&p.gmat_aw&&($(".select-box").eq(2).find(".select-title").hasClass("error")?$(".select-box").eq(2).find(".select-title").removeClass("error"):"0px"==$(".select-box").eq(3).find(".select-content").css("height")&&$(".select-box").eq(3).find(".select-title-control").click()))}function m(e){$.ajax({url:"/completeform/chinaschool.action",data:{schoolname:e},type:"post",cache:!1,dataType:"html",success:function(e){$("#select-school ul").html(e),$(".select-info-school").find(".form-select-option").removeClass("hidden"),$("#select-school").scrollbar()},error:function(){s.notice("网络错误")}})}function d(e,t){$.ajax({url:"/completeform/chinamajor.action",data:{majorname:e},type:"post",cache:!1,dataType:"html",success:function(e){1==t?($("#select-major ul").html(e),$(".select-info-major").find(".form-select-option").removeClass("hidden"),$("#select-major").scrollbar()):2==t&&($("#select-major2 ul").html(e),$(".select-info-major2").find(".form-select-option").removeClass("hidden"),$("#select-major2").scrollbar())},error:function(){s.notice("网络错误")}})}function h(){function e(e){for(var t=0;t<e.length;t++)if(e[t]>0)return!0;return!1}p.nation.length<=0||p.locatioin<=0?($(".select-box").eq(0).find(".select-title").addClass("error"),0==parseInt($(".select-box").eq(0).find(".select-content").css("height"))&&(g=!0,$(".select-box").eq(0).find(".select-title-control").click()),p.nation.length<=0&&$(".select-country .select-preference-title").addClass("red"),p.locatioin.length<=0&&$(".select-position .select-preference-title").addClass("red")):parseInt($(".select-box").eq(0).find(".select-content").css("height"))>0&&(g=!0,$(".select-box").eq(0).find(".select-title-control").click()),p.pre_school&&p.school_type&&p.pre_major&&p.grade&&null!=p.related_major&&p.degree?parseInt($(".select-box").eq(1).find(".select-content").css("height"))>0&&(g=!0,$(".select-box").eq(1).find(".select-title-control").click()):($(".select-box").eq(1).find(".select-title").addClass("error"),0==parseInt($(".select-box").eq(1).find(".select-content").css("height"))&&(g=!0,$(".select-box").eq(1).find(".select-title-control").click()),p.pre_school&&p.school_type||$(".select-info-school .form-item-name").addClass("red"),p.pre_major||$(".select-info-major .form-item-name").addClass("red"),p.grade||$(".select-school-type .form-item-name").addClass("red"),p.related_major||$(".select-major-only .form-item-name").addClass("red"),p.degree||$(".select-degree .form-item-name").addClass("red"));var t={};t.overall=null,t.R=null,t.L=null,t.S=null,t.W=null;var l={};l.overall=null,l.V=null,l.Q=null,l.AW=null,"toefl"==p.language?(t.overall=p.toefl,t.R=p.toefl_r,t.L=p.toefl_l,t.S=p.toefl_s,t.W=p.toefl_w):"ielts"==p.language&&(t.overall=p.ielts,t.R=p.ielts_r,t.L=p.ielts_l,t.S=p.ielts_s,t.W=p.ielts_w),"gre"==p.exam?(l.overall=p.gre,l.V=p.gre_v,l.Q=p.gre_q,l.AW=p.gre_aw):"gmat"==p.exam&&(l.overall=p.gmat,l.V=p.gmat_v,l.Q=p.gmat_q,l.AW=p.gmat_aw),"法学"==p.pre_major?p.gpa&&p.language&&t.overall&&t.R&&t.L&&t.S&&t.W&&null!=p.lsat?parseInt($(".select-box").eq(2).find(".select-content").css("height"))>0&&(g=!0,$(".select-box").eq(2).find(".select-title-control").click()):($(".select-box").eq(2).find(".select-title").addClass("error"),0==parseInt($(".select-box").eq(2).find(".select-content").css("height"))&&(g=!0,$(".select-box").eq(2).find(".select-title-control").click()),p.gpa||$(".select-score-gpa .form-item-name").addClass("red"),!$.isEmptyObject(p.language)&&t.overall&&t.R&&t.L&&t.S&&t.W||$(".select-language .form-item-name").addClass("red"),null==p.lsat&&$(".select-form-lsat .form-item-name").addClass("red")):p.gpa&&p.language&&t.overall&&t.R&&t.L&&t.S&&t.W&&p.exam&&l.overall&&l.V&&l.Q&&l.AW?parseInt($(".select-box").eq(2).find(".select-content").css("height"))>0&&(g=!0,$(".select-box").eq(2).find(".select-title-control").click()):($(".select-box").eq(2).find(".select-title").addClass("error"),0==parseInt($(".select-box").eq(2).find(".select-content").css("height"))&&(g=!0,$(".select-box").eq(2).find(".select-title-control").click()),p.gpa||$(".select-score-gpa .form-item-name").addClass("red"),!$.isEmptyObject(p.language)&&t.overall&&t.R&&t.L&&t.S&&t.W||$(".select-language .form-item-name").addClass("red"),!$.isEmptyObject(p.exam_score)&&l.overall&&l.V&&l.Q&&l.AW||$(".select-exam .form-item-name").addClass("red"));var n=[0,0,0];return 1!=p.achievement[0]||e(p.international_paper_num)?n[0]=1:n[0]=0,1!=p.achievement[1]||e(p.chinese_paper_num)?n[1]=1:n[1]=0,1!=p.achievement[2]||e(p.meeting_paper_num)?n[2]=1:n[2]=0,1==n[0]&&1==n[1]&&1==n[2]?parseInt($(".select-box").eq(3).find(".select-content").css("height"))>0&&(g=!0,$(".select-box").eq(3).find(".select-title-control").click()):($(".select-box").eq(3).find(".select-title").addClass("error"),$(".select-achievement .form-item-name").eq(0).addClass("red"),0==parseInt($(".select-box").eq(3).find(".select-content").css("height"))&&(g=!0,$(".select-box").eq(3).find(".select-title-control").click())),$(".select-title").hasClass("error")?($(".notice").addClass("red"),void s.notice("页面中有必填项未填，请检查",function(){$(".notice").removeClass("red")})):(formdata={nation:p.nation,locatioin:p.locatioin,pre_school:p.pre_school,school_type:p.school_type,pre_major:p.pre_major,pre_major2:p.pre_major2,grade:p.grade,related_major:p.related_major,degree:p.degree,gpa:p.gpa,toefl:p.toefl,toefl_r:p.toefl_r,toefl_l:p.toefl_l,toefl_s:p.toefl_s,toefl_w:p.toefl_w,ielts:p.ielts,ielts_r:p.ielts_r,ielts_l:p.ielts_l,ielts_s:p.ielts_s,ielts_w:p.ielts_w,gre:p.gre,gre_v:p.gre_v,gre_q:p.gre_q,gre_aw:p.gre_aw,gmat:p.gmat,gmat_v:p.gmat_v,gmat_q:p.gmat_q,gmat_aw:p.gmat_aw,lsat:p.lsat,exchange:p.exchange,science_rank:p.science_rank,science_time:p.science_time,recommend_rank:p.recommend_rank,international_paper_rank:p.international_paper_rank,international_paper_num:p.international_paper_num,chinese_paper_rank:p.chinese_paper_rank,chinese_paper_num:p.chinese_paper_num,meeting_paper_rank:p.meeting_paper_rank,meeting_paper_num:p.meeting_paper_num,work_rank:p.work_rank,work_time:p.work_time,prize:p.prize,match:p.match},void $.ajax({url:"/v1/completeform/saveform.action",data:formdata,type:"post",cache:!1,dataType:"json",success:function(e){0===e.code&&(localStorage.setItem("completedForm",!0),$.ajax({url:"/v1/completeform/intelligentselection.action",type:"GET",cache:!1,dataType:"json",success:function(e){e.data.Sprint||e.data.Middle||e.data.Bottom?window.location.href="/recommendation":($(".select-form-noresult").removeClass("hidden"),$(".mask").removeClass("hidden"))},error:function(){s.notice("网络错误")}}))},error:function(){s.notice("网络错误")}}))}function u(e,t,l,s){function n(e){for(var t=[],l=0;l<e.length;l++)e[l].x<=s.x&&t.push(e[l]);return t}function a(e){for(var t=[],l=0;l<e.length;l++)t.push(e[l].x);for(var s=i.max(t),n=0;n<e.length;n++)if(e[n].x==s)return e[n]}function o(e){for(var t=[],l=0;l<e.length;l++)t.push(e[l].x);for(var s=i.min(t),n=0;n<e.length;n++)if(e[n].x==s)return e[n]}function c(e){var t={stroke:"",fill:""};return s.x>parseInt(l.x)+parseInt((s.x-l.x)/2)?(t.stroke="#55ccff",t.fill="#bdeafc"):s.x>l.x&&s.x<=parseInt(l.x)+parseInt((s.x-l.x)/2)?(t.stroke="#72d38a",t.fill="#c7f6d5"):s.x<=l.x&&(t.stroke="#f14141",t.fill="#ffcccc"),t}$(e).find("svg")&&$(e).find("svg").remove();var r=n(t),f=a(t),m=o(t),d=c(t),h=500,u=250,p={left:50,top:50,right:50,bottom:25},g=h-p.left-p.right,v=u-p.top-p.bottom,_=i.select(e).append("svg").attr("width",h).attr("height",u).append("g").attr("transform","translate("+p.left+","+p.top+")"),x=i.scaleLinear().domain([m.x,f.x]).range([0,g]),k=i.scaleLinear().domain([0,l.y]).range([v,0]),C=i.area().x(function(e){return x(e.x)}).y0(v).y1(function(e){return k(e.y)}).curve(i.curveCatmullRom.alpha(.5)),b=i.line().x(function(e){return x(e.x)}).y(function(e){return k(e.y)-1}).curve(i.curveCatmullRom.alpha(.5));_.append("path").attr("class","svg-area").style("fill",d.fill).attr("d",C(r)),_.append("path").attr("class","svg-line").style("stroke",d.stroke).attr("d",b(t)),_.append("g").append("circle").style("fill",d.fill).attr("cx",x(l.x)).attr("cy",0).transition().duration(1e3).attr("cx",x(l.x)).attr("cy",k(l.y)).attr("r",5),_.append("g").append("circle").attr("class","svg-dot").style("stroke",d.stroke).attr("cx",x(s.x)).attr("cy",0).transition().duration(1e3).attr("cx",x(s.x)).attr("cy",k(s.y)).attr("r",4),_.append("g").append("line").style("stroke","#ffffff").style("stroke-width",1).attr("x1",x(l.x)).attr("y1",v).attr("x2",x(l.x)).attr("y2",v).transition().duration(1e3).attr("y2",0),_.append("g").append("line").style("stroke","#dcdcdc").style("stroke-width",1).attr("x1",0).attr("y1",v+2).attr("x2",g).attr("y2",v+2),_.append("g").append("text").attr("x",x(l.x)-36).attr("y",0).transition().duration(1e3).attr("x",x(l.x)-36).attr("y",k(l.y)-15).text("大多数人得分"),_.append("g").append("text").attr("x",x(s.x)-24).attr("y",0).transition().duration(1e3).attr("x",x(s.x)-24).attr("y",k(s.y)-15).text("我的得分"),_.append("g").append("text").attr("x",x(l.x)-8).attr("y",0).text(l.x).transition().duration(1e3).attr("x",x(l.x)-8).attr("y",v-5),_.append("g").append("text").attr("x",x(s.x)-8).attr("y",0).text(s.x).transition().duration(1e3).attr("x",x(s.x)-8).attr("y",v-5),_.append("g").append("text").attr("x",0).attr("y",v+20).text("最低分"),_.append("g").append("text").attr("x",0).attr("y",v-5).text(m.x),_.append("g").append("text").attr("x",g-36).attr("y",v+20).text("最高分"),_.append("g").append("text").attr("x",g-8).attr("y",v-5).text(f.x)}$(".select-school-buttons button").eq(0).click(function(){window.location.href="/form"}),$(".select-school-buttons button").eq(1).click(function(){window.location.href="/addApply"});var p={};p.nation=[],p.locatioin=[],p.pre_school=null,p.school_type=null,p.pre_major=null,p.pre_major2=null,p.grade=null,p.related_major=null,p.degree=null,p.gpa=null,p.language=null,p.toefl=null,p.toefl_r=null,p.toefl_l=null,p.toefl_s=null,p.toefl_w=null,p.ielts=null,p.ielts_r=null,p.ielts_l=null,p.ielts_s=null,p.ielts_w=null,p.exam=null,p.gre=null,p.gre_v=null,p.gre_q=null,p.gre_aw=null,p.gmat=null,p.gmat_v=null,p.gmat_q=null,p.gmat_aw=null,p.lsat=null,p.exchange=[0,0,0],p.science_rank=[0,0,0],p.science_time=[0,0,0],p.recommend_rank=[0,0,0],p.achievement=[0,0,0],p.international_paper_rank=[0,0,0],p.international_paper_num=[0,0,0],p.chinese_paper_rank=[0,0,0],p.chinese_paper_num=[0,0,0],p.meeting_paper_rank=[0,0],p.meeting_paper_num=[0,0],p.work_rank=[0,0,0],p.work_time=[0,0,0],p.prize=0,p.match=0;var g=!0,v=[];$(function(){function e(){for(var e=[],t=0;t<$(".select-info-school .form-select-option li").length;t++)e.push($(".select-info-school .form-select-option li").eq(t).html());return e.indexOf($(".select-school").val())==-1?(p.pre_school=null,p.school_type=null,void s.testFail($(".select-school"),"请从下拉列表中选择学校")):(s.testSuccess($(".select-school")),p.pre_school=$(".select-school").val(),p.school_type=$(".select-school").data("type"),p.pre_school&&p.school_type&&$(".select-info-school .form-item-name").removeClass("red"),void r())}function t(){for(var e=[],t=0;t<$(".select-info-major .form-select-option li").length;t++)e.push($(".select-info-major .form-select-option li").eq(t).html());return e.indexOf($(".select-major").val())==-1?(p.pre_major=null,void s.testFail($(".select-major"),"请从下拉列表中选择专业")):(s.testSuccess($(".select-major")),p.pre_major=$(".select-major").val(),"法学"==p.pre_major?($(".select-form-lsat").removeClass("hidden"),$(".select-exam").addClass("hidden")):($(".select-form-lsat").addClass("hidden"),$(".select-exam").removeClass("hidden")),p.pre_major&&$(".select-info-major .form-item-name").removeClass("red"),void r())}function l(){for(var e=[],t=0;t<$(".select-info-major2 .form-select-option li").length;t++)p.pre_major2=null,e.push($(".select-info-major2 .form-select-option li").eq(t).html());return e.indexOf($(".select-major2").val())==-1?void s.testFail($(".select-major2"),"请从下拉列表中选择专业"):(s.testSuccess($(".select-major2")),void(p.pre_major2=$(".select-major2").val()))}function i(e,t){var l=e.val(),s=/.*\..*/;s.test(l)&&e.val(l.substring(0,l.indexOf(".")+t+1))}$(".select-special").select(),$(".science-select1").select(),$(".science-select2").select(),$(".work-select1").select(),$(".work-select2").select(),$(".prize-select1").select(),$(".prize-select2").select(),$(".select-school-type").radio(),$(".select-major-only").radio(),$(".select-degree").radio(),$(".select-language").radio(),$(".select-exam").radio(),$(".select-exchange").check(),$(".select-science").check(),$(".select-recommend").check(),$(".select-achievement").check(),$(".select-work").check(),$(".select-prize").check(),$(".select-form")[0]&&$(".header-user-info").hasClass("hidden")?n.openIndexLogin():$(".select-form-view")[0]&&(localStorage.getItem("completedForm")||a()),!$(".header-user-info").hasClass("hidden")&&localStorage.getItem("completedForm")&&$(".header-nav li").eq(1).find("a").attr("href","/recommendation"),$(".select-form-view").on("click",function(e){e.stopPropagation()}),$(".select-form-view button").on("click",function(){s.closeAll.closeSelectView()}),o(),$(".select-title").on("click",function(){if(g){g=!1;var e=$(this).parents(".select-box").find(".select-content"),t=$(".select-box").index($(this).parents(".select-box"));v[t]?v[t]&&0!==e.innerHeight()&&(v[t]=e.innerHeight()):v[t]=e.innerHeight(),"0px"==e.css("height")?($(this).find("img").removeClass("animated rotateDown").addClass("animated rotateUp"),e.animate({height:v[t]},200,function(){g=!0})):($(this).find("img").removeClass("animated rotateUp").addClass("animated rotateDown"),e.animate({height:0},200,function(){g=!0}))}}),$(".select-country .select-preference-radio").on("click",function(){$(this).hasClass("active")?(p.nation.splice(p.nation.indexOf($(this).data("value")),1),$(this).removeClass("active")):(p.nation.push($(this).data("value")),$(this).addClass("active"),$(".select-country .select-preference-title").removeClass("red")),c()}),$(".select-position .select-preference-radio").on("click",function(){$(this).hasClass("active")?(p.locatioin.splice(p.locatioin.indexOf($(this).data("value")),1),$(this).removeClass("active")):(p.locatioin.push($(this).data("value")),$(this).addClass("active"),$(".select-position .select-preference-title").removeClass("red")),c()}),$(".select-school").on("input propertychange",function(){m($(this).val())}),$(".select-info-school .form-select-option").on("click","li",function(){$(".select-school").val($(this).html()),$(".select-school").data("type",$(this).data("type")),e()}),$(".select-school").on("blur",function(){setTimeout(function(){e()},300)}),$(".select-major").on("input propertychange",function(){d($(this).val(),1)}),$(".select-info-major .form-select-option").on("click","li",function(){$(".select-major").val($(this).html()),t()}),$(".select-major").on("blur",function(){setTimeout(function(){t()},300)}),$(".select-major2").on("input propertychange",function(){d($(this).val(),2)}),$(".select-info-major2 .form-select-option").on("click","li",function(){$(".select-major2").val($(this).html()),l()}),$(".select-major2").on("blur",function(){setTimeout(function(){l()},300)}),$(".select-school-type .form-radio").on("click",function(){p.grade=$(this).find(".form-radio-value").html(),$(".select-school-type .form-item-name").removeClass("red"),r()}),$(".select-major-only .form-radio").on("click",function(){1==$(this).data("value")?$(".select-info-major2").removeClass("hidden"):0==$(this).data("value")&&$(".select-info-major2").addClass("hidden"),p.related_major=$(this).data("value"),$(".select-major-only .form-item-name").removeClass("red"),r()}),$(".select-degree .form-radio").on("click",function(){p.degree=$(this).data("value"),$(".select-degree .form-item-name").removeClass("red"),r()}),$(".select-gpa").on("input propertychange",function(){var e=$(this).val(),t=/.*\..*/;t.test(e)&&$(this).val(e.substring(0,e.indexOf(".")+3))}),$(".select-gpa").on("blur",function(){$(this).testInput({rule:s.isDouble,success:function(e){return e.val()>100?(p.gpa=null,void s.testFail(e,"您输入的分数有误")):(s.testSuccess(e),void(p.gpa=e.val()))},fail:function(e){p.gpa=null,s.testFail(e,"您输入的分数有误")}}),p.gpa&&$(".select-score-gpa .form-item-name").removeClass("red"),f()}),$(".select-language .form-radio").on("click",function(){$(".select-language-input").hasClass("hidden")&&(v[2]=parseInt(v[2]+$(".select-language-input").innerHeight()+"px"),$(".select-score").css("height",v[2])),$(".select-language-input").removeClass("hidden"),"TOEFL"==$(this).find(".form-radio-value").html()?(p.language="toefl",p.ielts=null,p.ielts_r=null,p.ielts_l=null,p.ielts_s=null,p.ielts_w=null):"IELTS"==$(this).find(".form-radio-value").html()&&(p.language="ielts",p.toefl=null,p.toefl_r=null,p.toefl_l=null,p.toefl_s=null,p.toefl_w=null),$(".select-language-input input").removeClass("error").val("")}),$(".select-language-overall").on("input propertychange",function(){"toefl"==p.language?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>120?(p.toefl=null,void s.testFail(e,"TOFEL有效分值为0~120分")):(p.toefl=e.val(),void s.testSuccess(e))},fail:function(e){p.toefl=null,s.testFail(e,"TOFEL有效分值为0~120分")}}):"ielts"==p.language&&(i($(this),1),$(this).testInput({rule:s.isFloat,success:function(e){return e.val()<0||e.val()>9?(p.ielts=null,void s.testFail(e,"IELTS有效分值为0~9分")):(p.ielts=e.val(),void s.testSuccess(e))},fail:function(e){p.ielts=null,s.testFail(e,"IELTS有效分值为0~9分")}}))}),$(".select-language-r").on("input propertychange",function(){"toefl"==p.language?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>30?(p.toefl_r=null,void s.testFail(e,"TOFEL分项成绩有效分值为0~30分")):(p.toefl_r=e.val(),void s.testSuccess(e))},fail:function(e){p.toefl_r=null,s.testFail(e,"TOFEL分项成绩有效分值为0~30分")}}):"ielts"==p.language&&(i($(this),1),$(this).testInput({rule:s.isFloat,success:function(e){return e.val()<0||e.val()>9?(p.ielts_r=null,void s.testFail(e,"IELTS分项成绩有效分值为0~9")):(p.ielts_r=e.val(),void s.testSuccess(e))},fail:function(e){p.ielts_r=null,s.testFail(e,"IELTS分项成绩有效分值为0~9")}}))}),$(".select-language-l").on("input propertychange",function(){"toefl"==p.language?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>30?(p.toefl_l=null,void s.testFail(e,"TOFEL分项成绩有效分值为0~30分")):(p.toefl_l=e.val(),void s.testSuccess(e))},fail:function(e){p.toefl_l=null,s.testFail(e,"TOFEL分项成绩有效分值为0~30分")}}):"ielts"==p.language&&(i($(this),1),$(this).testInput({rule:s.isFloat,success:function(e){return e.val()<0||e.val()>9?(p.ielts_l=null,void s.testFail(e,"IELTS分项成绩有效分值为0~9")):(p.ielts_l=e.val(),void s.testSuccess(e))},fail:function(e){p.ielts_l=null,s.testFail(e,"IELTS分项成绩有效分值为0~9")}}))}),$(".select-language-s").on("input propertychange",function(){"toefl"==p.language?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>30?(p.toefl_s=null,void s.testFail(e,"TOFEL分项成绩有效分值为0~30分")):(p.toefl_s=e.val(),void s.testSuccess(e))},fail:function(e){p.toefl_s=null,s.testFail(e,"TOFEL分项成绩有效分值为0~30分")}}):"ielts"==p.language&&(i($(this),1),$(this).testInput({rule:s.isFloat,success:function(e){return e.val()<0||e.val()>9?(p.ielts_s=null,void s.testFail(e,"IELTS分项成绩有效分值为0~9")):(p.ielts_s=e.val(),void s.testSuccess(e))},fail:function(e){p.ielts_s=null,s.testFail(e,"IELTS分项成绩有效分值为0~9")}}))}),$(".select-language-w").on("input propertychange",function(){"toefl"==p.language?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>30?(p.toefl_w=null,void s.testFail(e,"TOFEL分项成绩有效分值为0~30分")):(p.toefl_w=e.val(),void s.testSuccess(e))},fail:function(e){p.toefl_w=null,s.testFail(e,"TOFEL分项成绩有效分值为0~30分")}}):"ielts"==p.language&&(i($(this),1),$(this).testInput({rule:s.isFloat,success:function(e){return e.val()<0||e.val()>9?(p.ielts_w=null,void s.testFail(e,"IELTS分项成绩有效分值为0~9")):(p.ielts_w=e.val(),void s.testSuccess(e))},fail:function(e){p.ielts_w=null,s.testFail(e,"IELTS分项成绩有效分值为0~9")}}))}),$(".select-language-input input").on("focus",function(){$(this).hasClass("error")&&$(this).parent(".form-item").find(".form-item-notice").css("display","block")}),$(".select-language-input input").on("blur",function(){$(this).parent(".form-item").find(".form-item-notice").css("display","none"),"toefl"==p.language?p.toefl&&p.toefl_r&&p.toefl_l&&p.toefl_s&&p.toefl_w&&$(".select-language .form-item-name").removeClass("red"):"ielts"==p.language&&p.ielts&&p.ielts_r&&p.ielts_l&&p.ielts_s&&p.ielts_w&&$(".select-language .form-item-name").removeClass("red"),f()}),$(".select-exam .form-radio").on("click",function(){$(".select-exam-input").hasClass("hidden")&&(v[2]=parseInt(v[2]+$(".select-exam-input").innerHeight()+"px"),$(".select-score").css("height",v[2])),$(".select-exam-input").removeClass("hidden"),"GRE"==$(this).find(".form-radio-value").html()?(p.exam="gre",p.gmat=null,p.gmat_v=null,p.gmat_q=null,p.gmat_aw=null):"GMAT"==$(this).find(".form-radio-value").html()&&(p.exam="gmat",p.gre=null,p.gre_v=null,p.gre_q=null,p.gre_aw=null),$(".select-exam-input input").removeClass("error").val("")}),$(".select-exam-overall").on("input propertychange",function(){"gre"==p.exam?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>340?(p.gre=null,void s.testFail(e,"GRE有效分值为0~340")):(p.gre=e.val(),void s.testSuccess(e))},fail:function(e){p.gre=null,s.testFail(e,"GRE有效分值为0~340")}}):"gmat"==p.exam&&$(this).testInput({rule:s.isInt,success:function(e){return e.val()<200||e.val()>800?(p.gmat=null,void s.testFail(e,"GMAT有效分值为200~800")):(p.gmat=e.val(),void s.testSuccess(e))},fail:function(e){p.gmat=null,s.testFail(e,"GMAT有效分值为200~800")}})}),$(".select-exam-v").on("input propertychange",function(){"gre"==p.exam?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>170?(p.gre_v=null,void s.testFail(e,"GRE分项（V、Q ）成绩有效分值为0~170")):(p.gre_v=e.val(),void s.testSuccess(e))},fail:function(e){p.gre_v=null,s.testFail(e,"GRE分项（V、Q ）成绩有效分值为0~170")}}):"gmat"==p.exam&&$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>60?(p.gmat_v=null,void s.testFail(e,"GMAT分项（V、Q) 有效成绩分值为0~60")):(p.gmat_v=e.val(),void s.testSuccess(e))},fail:function(e){p.gmat_v=null,s.testFail(e,"GMAT分项（V、Q) 有效成绩分值为0~60")}})}),$(".select-exam-q").on("input propertychange",function(){"gre"==p.exam?$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>170?(p.gre_q=null,void s.testFail(e,"GRE分项（V、Q ）成绩有效分值为0~170")):(p.gre_q=e.val(),void s.testSuccess(e))},fail:function(e){p.gre_q=null,s.testFail(e,"GRE分项（V、Q ）成绩有效分值为0~170")}}):"gmat"==p.exam&&$(this).testInput({rule:s.isInt,success:function(e){return e.val()<0||e.val()>60?(p.gmat_q=null,void s.testFail(e,"GMAT分项（V、Q) 有效成绩分值为0~60")):(p.gmat_q=e.val(),void s.testSuccess(e))},fail:function(e){p.gmat_q=null,s.testFail(e,"GMAT分项（V、Q) 有效成绩分值为0~60")}})}),$(".select-exam-aw").on("input propertychange",function(){i($(this),1),"gre"==p.exam?$(this).testInput({rule:s.isFloat,success:function(e){return e.val()<0||e.val()>6?(p.gre_aw=null,void s.testFail(e,"AW有效成绩分值为0~6")):(p.gre_aw=e.val(),void s.testSuccess(e))},fail:function(e){p.gre_aw=null,s.testFail(e,"AW有效成绩分值为0~6")}}):"gmat"==p.exam&&$(this).testInput({rule:s.isFloat,success:function(e){return e.val()<0||e.val()>6?(p.gmat_aw=null,void s.testFail(e,"AW有效成绩分值为0~6")):(p.gmat_aw=e.val(),void s.testSuccess(e))},fail:function(e){p.gmat_aw=null,s.testFail(e,"AW有效成绩分值为0~6")}})}),$(".select-exam-input input").on("focus",function(){$(this).hasClass("error")&&$(this).parent(".form-item").find(".form-item-notice").css("display","block")}),$(".select-exam-input input").on("blur",function(){$(this).parent(".form-item").find(".form-item-notice").css("display","none"),"gre"==p.exam?p.gre&&p.gre_v&&p.gre_q&&p.gre_aw&&$(".select-exam .form-item-name").removeClass("red"):"gmat"==p.exam&&p.gmat&&p.gmat_v&&p.gmat_q&&p.gmat_aw&&$(".select-exam .form-item-name").removeClass("red"),f()}),$(".select-lsat").on("blur",function(){0==$(".select-lsat").val()?(p.lsat=0,s.testSuccess($(this))):$(this).testInput({rule:s.isInt,success:function(e){return e.val()>180||e.val()<120?(p.lsat=null,void s.testFail(e,"LAST有效分值为120~180")):(p.lsat=e.val(),void s.testSuccess(e))},fail:function(e){p.lsat=null,s.testFail(e,"LAST有效分值为120~180")}}),console.log(null!==p.lsat),null!==p.lsat&&$(".select-form-lsat .form-item-name").removeClass("red"),f()}),$(".select-exchange .form-check").on("click",function(){var e=$(this).parents(".select-exchange").find(".form-check").index($(this));0==p.exchange[e]?p.exchange[e]=$(this).data("value"):p.exchange[e]=0}),$(".select-science .form-check").on("click",function(){var e=$(this).parents(".select-science").find(".form-check").index($(this));0==p.science_rank[e]?($(this).find(".form-select").removeClass("hidden"),$(this).find(".form-select")[0]&&(v[3]=parseInt(v[3])+$(this).find(".form-select").innerHeight()+"px"),p.science_rank[e]=$(this).data("value"),2==e?p.science_time[e]=1:p.science_time[e]=$(this).find(".form-select-option li").eq(0).data("value")):($(this).find(".form-select").addClass("hidden"),$(this).find(".form-select")[0]&&(v[3]=parseInt(v[3])-$(this).find(".form-select").innerHeight()+"px"),p.science_rank[e]=0,p.science_time[e]=0),$(".select-other").css("height",v[3])}),$(".select-science .form-select").on("click",function(e){e.stopPropagation()}),$(".select-science .form-select-option li").on("click",function(e){e.stopPropagation();var t=$(this).data("value"),l=$(this).parents(".form-item").find(".form-select").index($(this).parents(".form-select"));p.science_time[l]=t}),$(".select-recommend .form-check").on("click",function(){var e=$(this).parents(".select-recommend").find(".form-check").index($(this));0==p.recommend_rank[e]?p.recommend_rank[e]=$(this).data("value"):p.recommend_rank[e]=0,console.log(p.recommend_rank)}),$(".select-achievement .form-check").on("click",function(){var e=$(this).parents(".select-achievement").find(".form-check").index($(this));switch(e){case 0:$(this).find(".form-check-input").hasClass("hidden")?($(this).find(".form-check-input").removeClass("hidden"),v[3]=parseInt(v[3])+$(this).find(".form-check-input").innerHeight()+"px",$(".select-other").css("height",v[3]),p.achievement[e]=1):($(this).find(".form-check-input").addClass("hidden"),v[3]=parseInt(v[3])-$(this).find(".form-check-input").innerHeight()+"px",$(".select-other").css("height",v[3]),$(this).find(".form-check-input input").val(""),s.testSuccess($(this).find("input")),p.achievement[e]=0,p.international_paper_rank=[0,0,0],p.international_paper_num=[0,0,0]);break;case 1:$(this).find(".form-check-input").hasClass("hidden")?($(this).find(".form-check-input").removeClass("hidden"),v[3]=parseInt(v[3])+$(this).find(".form-check-input").innerHeight()+"px",$(".select-other").css("height",v[3]),p.achievement[e]=1):($(this).find(".form-check-input").addClass("hidden"),v[3]=parseInt(v[3])-$(this).find(".form-check-input").innerHeight()+"px",$(".select-other").css("height",v[3]),$(this).find(".form-check-input input").val(""),s.testSuccess($(this).find("input")),p.achievement[e]=0,p.chinese_paper_rank=[0,0,0],p.chinese_paper_num=[0,0,0]);break;case 2:$(this).find(".form-check-input").hasClass("hidden")?($(this).find(".form-check-input").removeClass("hidden"),v[3]=parseInt(v[3])+$(this).find(".form-check-input").innerHeight()+"px",$(".select-other").css("height",v[3]),p.achievement[e]=1):($(this).find(".form-check-input").addClass("hidden"),v[3]=parseInt(v[3])-$(this).find(".form-check-input").innerHeight()+"px",$(".select-other").css("height",v[3]),$(this).find(".form-check-input input").val(""),s.testSuccess($(this).find("input")),p.achievement[e]=0,p.meeting_paper_rank=[0,0],p.meeting_paper_num=[0,0])}0==p.achievement[e]&&0==p.achievement[1]&&0==p.achievement[2]&&($(".select-box").eq(3).find(".select-title").removeClass("error"),$(".select-achievement .form-item-name").eq(0).removeClass("red"))}),$(".select-achievement .form-check-input").on("click",function(e){e.stopPropagation()}),$(".select-achievement .form-check-input input").on("blur",function(){function e(e){for(var t=0;t<e.length;t++)if(e[t]>0)return!0;return!1}$(this).testInput({rule:s.isInt,success:function(e){var t=parseInt(e.val()),l=e.parents(".form-check-input").find("input").index(e),n=e.parents(".select-achievement").find(".form-check").index(e.parents(".form-check"));switch(n){case 0:p.international_paper_rank[l]=e.data("value"),p.international_paper_num[l]=t;break;case 1:p.chinese_paper_rank[l]=e.data("value"),p.chinese_paper_num[l]=t;break;case 2:p.meeting_paper_rank[l]=e.data("value"),p.meeting_paper_num[l]=t}s.testSuccess(e)},fail:function(e){var t=e.parents(".form-check-input").find("input").index(e),l=e.parents(".select-achievement").find(".form-check").index(e.parents(".form-check"));switch(l){case 0:p.international_paper_rank[t]=0,p.international_paper_num[t]=0;
break;case 1:p.chinese_paper_rank[t]=0,p.chinese_paper_num[t]=0;break;case 2:p.meeting_paper_rank[t]=0,p.meeting_paper_num[t]=0}s.testFail(e,"请输入整数数字")}}),(1!=p.achievement[0]||e(p.international_paper_num))&&(1!=p.achievement[1]||e(p.chinese_paper_num))&&(1!=p.achievement[2]||e(p.meeting_paper_num))&&($(".select-box").eq(3).find(".select-title").removeClass("error"),$(".select-achievement .form-item-name").eq(0).removeClass("red"))}),$(".select-work .form-check").on("click",function(){var e=$(this).parents(".select-work").find(".form-check").index($(this));0==p.work_rank[e]?($(this).find(".form-select").removeClass("hidden"),$(this).find(".form-select")[0]&&(v[3]=parseInt(v[3])+$(this).find(".form-select").innerHeight()+"px"),p.work_rank[e]=$(this).data("value"),2==e?p.work_time[e]=1:p.work_time[e]=$(this).find(".form-select-option li").eq(0).data("value")):($(this).find(".form-select").addClass("hidden"),$(this).find(".form-select")[0]&&(v[3]=parseInt(v[3])-$(this).find(".form-select").innerHeight()+"px"),p.work_rank[e]=0,p.work_time[e]=0),$(".select-other").css("height",v[3])}),$(".select-work .form-select").on("click",function(e){e.stopPropagation()}),$(".select-work .form-select-option li").on("click",function(e){e.stopPropagation();var t=$(this).index()+1,l=$(this).parents(".form-item").find(".form-select").index($(this).parents(".form-select"));p.work_time[l]=t}),$(".select-prize .form-check").on("click",function(){var e=$(this).parents(".select-prize").find(".form-check").index($(this));switch(e){case 0:$(this).find(".form-select").hasClass("hidden")?($(this).find(".form-select").removeClass("hidden"),v[3]=parseInt(v[3])+$(this).find(".form-select").innerHeight()+"px",$(".select-other").css("height",v[3]),p.prize=$(this).find(".form-select-option li").eq(0).data("value")):($(this).find(".form-select").addClass("hidden"),v[3]=parseInt(v[3])-$(this).find(".form-select").innerHeight()+"px",$(".select-other").css("height",v[3]),p.prize=0);break;case 1:$(this).find(".form-select").hasClass("hidden")?($(this).find(".form-select").removeClass("hidden"),v[3]=parseInt(v[3])+$(this).find(".form-select").innerHeight()+"px",$(".select-other").css("height",v[3]),p.match=$(this).find(".form-select-option li").eq(0).data("value")):($(this).find(".form-select").addClass("hidden"),v[3]=parseInt(v[3])-$(this).find(".form-select").innerHeight()+"px",$(".select-other").css("height",v[3]),p.match=0)}}),$(".select-prize .form-select").on("click",function(e){e.stopPropagation()}),$(".select-prize .form-select-option li").on("click",function(e){e.stopPropagation();var t=($(this).data("value"),$(this).parents(".form-item").find(".form-select").index($(this).parents(".form-select")));switch(t){case 0:p.prize=$(this).data("value");break;case 1:p.match=$(this).data("value")}console.log(p.prize),console.log(p.match)}),$(".select-submit").on("click",function(){h()}),$(".select-school").tab(),$(".school-list-main").on("mouseenter",function(){$(this).parent("li").hasClass("active")||($(this).animate({marginTop:0},200),$(this).find(".school-list-info").animate({height:40},200),$(this).find(".school-list-mask").fadeIn(200),$(this).find(".school-list-logo").addClass("blur"))}).on("mouseleave",function(){return $(this).parent("li").hasClass("active")?void $(this).find(".school-list-mask").fadeOut(200):($(this).animate({marginTop:40},200),$(this).find(".school-list-info").animate({height:0},200),$(this).find(".school-list-mask").fadeOut(200),void $(this).find(".school-list-logo").removeClass("blur"))}),$(".school-list-major span")[0]&&$(".school-list-major span").html().length>25&&($(".school-list-major span").html($(".school-list-major span").html().substring(0,25)+"..."),$(".school-list-info").on("mouseenter",function(e){e.stopPropagation(),$(this).find(".school-list-major-all").removeClass("hidden")}).on("mouseleave",function(e){e.stopPropagation(),$(this).find(".school-list-major-all").addClass("hidden")})),$(".switch-box").on("click",function(){$(this).hasClass("on")?($(this).find("img").animate({left:0},100),$(this).removeClass("on").addClass("off"),$(this).parent(".school-list-switch").find("span").html("点击加入申请")):$(this).hasClass("off")&&($(this).find("img").animate({left:30},100),$(this).removeClass("off").addClass("on"),$(this).parent(".school-list-switch").find("span").html("点击取消申请"))}),$(".school-list-main").on("click",function(e){if(!$(this).parent("li").hasClass("active")){$(".select-school-list li.active").find(".school-list-main").animate({marginTop:40},200),$(".select-school-list li.active").find(".school-list-info").animate({height:0},200),$(".select-school-list li").removeClass("active"),$(".select-school-list li").find(".school-list-mask").fadeOut(200),$(".select-school-list li").find(".school-list-logo").removeClass("blur"),$(this).parent("li").addClass("active"),$(this).parents(".tab-box").find(".select-school-rank").html($(this).parent("li").find(".school-list-rank").html());var t=$(this).parent("li").attr("school-id");console.log(t,"切换学校"),$.ajax({url:"/v1/Completeform/historyoffer.action",data:{id:t},type:"get",cache:!1,dataType:"json",success:function(e){u(".select-svg-gpa",e.data.gpa.data,e.data.gpa.max,e.data.gpa.user_data)},error:function(){s.notice("网络错误")}})}}),$(".select-school-switch").on("click",function(e){e.stopPropagation(),$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")})}),s.closeAll.closeSelectView=function(){s.closeMask(),$("body").css("overflow","auto"),$(".select-form-view").addClass("animated fadeOutUp").one(s.animationend,function(){$(".select-form-view").removeClass("animated fadeOutUp").addClass("hidden")})},$(".select-form-noresult-info").on("click",function(e){e.stopPropagation(),$(".select-form-noresult").addClass("hidden"),$(".mask").addClass("hidden")})});